
  <div class="page" data-controller="scroll-gradient">
    <div class="events-container py-5" data-controller="filters">
      <h1 class="page-title">
        <span class="animated-title">Discover all events</span>
      </h1>


      <div class="filters-card">
        <select data-filters-target="year" data-action="change->filters#apply" class="filter-select">
          <option value="">Toutes les ann√©es</option>
          <option value="2025">2025</option>
          <option value="2026">2026</option>
        </select>

        <select data-filters-target="country" data-action="change->filters#apply" class="filter-select">
          <option value="">Tous les pays</option>
          <% @events.map { |e| e[:country] }.uniq.sort.each do |country| %>
            <option value="<%= country %>"><%= country %></option>
          <% end %>
        </select>

        <select data-filters-target="difficulty" data-action="change->filters#apply" class="filter-select">
          <option value="">Tous niveaux</option>
          <% @events.map { |e| e[:difficulty] }.uniq.sort.each do |diff| %>
            <option value="<%= diff %>"><%= diff %></option>
          <% end %>
        </select>
      </div>

      <div class="row cards-wrapper" data-filters-target="cards">
        <% @events.each do |event| %>
          <div class="event-card-wrapper"
              data-year="<%= event[:date].year %>"
              data-country="<%= event[:country] %>"
              data-difficulty="<%= event[:difficulty] %>">
            <div class="event-card" data-controller="flip">
              <div class="event-card__inner">

                <%# FACE %>
                <div class="event-card__front" style="background-image: url('<%= event[:photo_url] %>');">
                  <h3><%= event[:title] %></h3>
                  <span class="event-card__badge <%= event[:difficulty] %>"><%= event[:difficulty] %></span>
                  <p><%= event[:date] %> ‚Ä¢ <%= event[:country] %></p>
                  <p><%= event[:type] %></p>
                  <button class="event-card__button" data-action="click->flip#toggle">En savoir plus ‚Üí</button>
                </div>

                <%# BACK %>
                <div class="event-card__back">
                  <div class="event-card-back-header">
                    <h4><%= event[:title] %></h4>
                    <%= button_to toggle_favorite_event_path(event),
                      method: :post,
                      remote: true,
                      class: "favorite-btn" do %>
                      <% if current_user.favorite_events.include?(event) %>
                        ‚ù§Ô∏è
                      <% else %>
                        ü§ç
                      <% end %>
                    <% end %>
                  </div>
                  <p>Ville : <%= event[:location] %></p>
                  <p>Dans <%= (event[:date] - Date.today).to_i %> jours</p>
                  <p>Distance : <%= event[:distance_km] %> km</p>
                  <p>D√©nivel√© : <%= event[:denivele] %> m</p>
                  <br>
                  <%= link_to "Cr√©er un goal", "/events/#{event[:id]}/goals/new", class: "event-card__button_tier" %>
                  <div class="event-card__buttons">
                    <button class="event-card__button" data-action="click->flip#toggle">‚Üê Retour</button>
                    <button class="event-card__button_second">
                      <a href="<%= event[:source_url] %>" target="_blank">Voir l'√©v√©nement</a>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>

    </div>
  </div>
